(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{159:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._m(1),a("p",[t._v("用过vue的同学应该都知道在vue里有个状态管理器，其实一开始我对vuex还不是很理解，甚至还不知道怎么用，今天就来聊聊vuex这东西，也帮助下新手了解下vuex，如果文中出现了理解有误的地方，还希望能够指出，一同进步，谢谢~")]),t._m(2),a("p",[t._v("以下是"),a("a",{attrs:{href:"https://vuex.vuejs.org/zh-cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuex官网"),a("OutboundLink")],1),t._v("给出的解释")]),a("blockquote",[a("p",[a("code",[t._v("Vuex")]),t._v(" 是一个专为 Vue.js 应用程序开发的"),a("strong",[t._v("状态管理模式")]),t._v("。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。Vuex 也集成到 Vue 的官方调试工具 "),a("a",{attrs:{href:"https://github.com/vuejs/vue-devtools",target:"_blank",rel:"noopener noreferrer"}},[t._v("devtools extension"),a("OutboundLink")],1),t._v("，提供了诸如零配置的 time-travel 调试、状态快照导入导出等高级调试功能。")])]),a("p",[t._v("我的理解简言之就是")]),t._m(3),t._m(4),t._m(5),t._m(6),t._m(7),t._m(8),t._m(9),t._m(10),t._m(11),t._m(12),t._m(13),a("ul",[t._m(14),a("li",[t._m(15),a("p",[t._v("不过"),a("a",{attrs:{href:"https://github.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("github"),a("OutboundLink")],1),t._v("上已经有不少人将两者结合变成一个插件的做法，这里推荐一个"),a("a",{attrs:{href:"https://github.com/robinvdvleuten/vuex-persistedstate",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuex-persistedstate"),a("OutboundLink")],1)]),t._m(16),t._m(17)])])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"vuex学习笔记"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vuex学习笔记","aria-hidden":"true"}},[this._v("#")]),this._v(" Vuex学习笔记")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言","aria-hidden":"true"}},[this._v("#")]),this._v(" 前言")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"什么是vuex"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是vuex","aria-hidden":"true"}},[this._v("#")]),this._v(" 什么是vuex")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[s("code",[this._v("vuex")]),this._v("是一个状态"),s("strong",[this._v("共享")]),this._v("管理器，多用于多组件之间的状态共享以及数据共享(并非唯一的选择)，再简单点就是一个"),s("strong",[this._v("实时响应的缓存")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"vuex和localstorage的区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vuex和localstorage的区别","aria-hidden":"true"}},[this._v("#")]),this._v(" vuex和localStorage的区别")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("上文也提到了"),s("code",[this._v("vuex")]),this._v("可以相当于一个缓存，也许有的同学在使用"),s("code",[this._v("vuex")]),this._v("的时候也会觉得，为什么不使用"),s("code",[this._v("localstorage")]),this._v("来的方便（我自己当初也这么觉得的，哈哈哈）？")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("不过确实，如果只是单单进行一个多组件之间的数据共享的话，那么绝大多数情况下，"),s("code",[this._v("localStorage")]),this._v("确实能够满足使用，但是别忘了，"),s("code",[this._v("vuex")]),this._v("可不只是能够进行数据共享，还能做些"),s("code",[this._v("localStorage")]),this._v("无法做到的事儿")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("比如有这么一个业务场景，比如在根组件"),a("code",[t._v("app.vue")]),t._v("下（或者其他组件也行）有个我们已经写好的分享组件"),a("code",[t._v("shareComponents.vue")]),t._v("，然后我在子组件"),a("code",[t._v("a.vue")]),t._v("和"),a("code",[t._v("b.vue")]),t._v("中各有一个按钮，当我点击这个按钮的时候分享组件"),a("code",[t._v("shareComponents.vue")]),t._v("就会弹出显示。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("然后我将分享组件"),a("code",[t._v("shareComponents.vue")]),t._v("的显示和隐藏状态存到"),a("code",[t._v("vuex")]),t._v("的"),a("code",[t._v("state")]),t._v("中去，那么我在"),a("code",[t._v("a.vue")]),t._v("和"),a("code",[t._v("b.vue")]),t._v("组件中只要操作"),a("code",[t._v("vuex")]),t._v("的这个"),a("code",[t._v("state")]),t._v("就行了，因为"),a("code",[t._v("vuex")]),t._v("的实时状态响应机制，只要"),a("code",[t._v("vuex")]),t._v("中的"),a("code",[t._v("state")]),t._v("一改变，那么只要其他组件里有这个共享的值时，都会实时改变。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("如果我们使用"),a("code",[t._v("localStorage")]),t._v("的话，我们先将控制"),a("code",[t._v("shareComponents.vue")]),t._v("显示隐藏状态的值存入"),a("code",[t._v("localStorage")]),t._v("，然后在子组件"),a("code",[t._v("a.vue")]),t._v("和"),a("code",[t._v("b.vue")]),t._v("中的点击事件去修改缓存中的值，那么结果会是什么？")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("缓存中的值是改变了，但是你会发现分享组件"),s("code",[this._v("shareComponents.vue")]),this._v("并没有弹出，这是为什么？原因其实很简单，我在这里修改了缓存中的值，但是在我要使用的地方需要重新"),s("code",[this._v("getItem")]),this._v("(localStorage API)后才能得到修改后的值，也就是"),s("code",[this._v("localStorage")]),this._v("并不具有实时性")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("这是"),a("code",[t._v("vuex")]),t._v("和"),a("code",[t._v("localStorage")]),t._v("不同区别的一点\n还有一点就是"),a("code",[t._v("localStorage")]),t._v("具有永久性，我们都知道，使用"),a("code",[t._v("localStorage")]),t._v("进行本地存储的时候，除非用户手动进行清理，否则缓存会一直存在本地当中")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("而反观"),a("code",[t._v("vuex")]),t._v("，每当页面重新刷新的时候，"),a("code",[t._v("vuex")]),t._v("就会重置所有的"),a("code",[t._v("state")]),t._v("状态为初始状态，这应该算是"),a("code",[t._v("vuex")]),t._v("的一个"),a("strong",[t._v("小缺点")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"如何解决vuex页面刷新重置所有状态的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何解决vuex页面刷新重置所有状态的问题","aria-hidden":"true"}},[this._v("#")]),this._v(" 如何解决vuex页面刷新重置所有状态的问题")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("li",[a("p",[t._v("配合"),a("code",[t._v("localStorage")]),t._v("\n在我们操作"),a("code",[t._v("vuex")]),t._v("中"),a("code",[t._v("state")]),t._v("的同时，将对应的状态也缓存到"),a("code",[t._v("localStorage")]),t._v("中，然后在state中优先获取缓存，这样可以避免页面刷新，状态重置的问题，具体实现如下：")]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// 我们先在state.js中定义状态值 以token为例")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" str "),a("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'good-storage'")]),t._v(" #一个操作localStorage的库 具体可看    https"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("github"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("ustbhuangyi"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("storage\n"),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" state "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  token"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" str"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'token'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" str"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'token'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" state\n")])])]),a("p",[t._v("然后我以登录为示例，登录成功，获取"),a("code",[t._v("token")]),t._v("值")]),a("div",{staticClass:"language-vue extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n...\n// 省略html片段结构\n"),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{attrs:{class:"token script language-javascript"}},[t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" str "),a("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'good-storage'")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  methods"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("login")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("\n      "),a("span",{attrs:{class:"token comment"}},[t._v("// 省略一些代码逻辑")]),t._v("\n      "),a("span",{attrs:{class:"token function"}},[t._v("login")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("userInfo"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("then")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'登录成功'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n         str"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("set")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'token'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("token"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{attrs:{class:"token comment"}},[t._v("// 将token存入缓存")]),t._v("\n         "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token constant"}},[t._v("SET_TOKEN")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("token"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{attrs:{class:"token comment"}},[t._v("// 这里就是将token存入state中 涉及到了mutation操作state 之后会说")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" err "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")]),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("虽然有些麻烦，每次操作state的同时还得缓存一次，不过这也是一种解决方式了")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("使用其他已经结合"),s("code",[this._v("vuex")]),this._v("和"),s("code",[this._v("localStorage")]),this._v("的工具\n因为第一种方法还得做一次缓存的操作，有时候确实会觉得很麻烦，尤其是"),s("code",[this._v("state")]),this._v("比较多的时候")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("这个插件会在你每次操作"),s("code",[this._v("state")]),this._v("的时候 都将整个"),s("code",[this._v("state")]),this._v("都存入缓存中去 从而避免我们进一次的缓存操作 也算是比较便捷")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("唯一觉得有缺点的是 如果要重置"),s("code",[this._v("state")]),this._v("状态的话 会比较麻烦")])}],!1,null,null,null);s.default=e.exports}}]);