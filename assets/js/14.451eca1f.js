(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{164:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._m(1),t._m(2),t._m(3),t._m(4),t._m(5),t._m(6),t._m(7),t._m(8),t._m(9),t._m(10),t._m(11),t._m(12),t._m(13),a("img",{attrs:{src:t.$withBase("/assets/mongodb/init_mongodb.png")}}),t._m(14),t._m(15),t._m(16),t._m(17),t._m(18),t._m(19),t._m(20),t._m(21),t._m(22),t._m(23),t._m(24),t._m(25),t._m(26),t._m(27),t._m(28),a("p",[t._v("要创建数据集合有两种方式：")]),t._m(29),t._m(30),t._m(31),t._m(32),t._m(33),t._m(34),t._m(35),t._m(36),t._m(37),a("p",[t._v("插入数据的写法有四种：")]),t._m(38),t._m(39),t._m(40),t._m(41),t._m(42),a("p",[t._v("参数说明：")]),t._m(43),a("p",[t._v("来个例子，我们先插入一条数据，然后再更新这条数据：")]),t._m(44),t._m(45),t._m(46),a("p",[t._v("参数说明：")]),t._m(47),a("p",[t._v("举个例子：")]),t._m(48),t._m(49),a("p",[t._v("删除文档的方法：")]),t._m(50),a("p",[t._v("例子：")]),t._m(51),t._m(52),t._m(53),t._m(54),t._m(55),a("p",[t._v("参数说明：")]),t._m(56),t._m(57),t._m(58),t._m(59),t._m(60),t._m(61),t._m(62),a("p",[t._v("查询文档指定条数，比如分页查询时使用：")]),t._m(63),t._m(64),a("p",[t._v("查询时跳过指定条数的数据进行查询：")]),t._m(65),t._m(66),t._m(67),t._m(68),t._m(69),t._m(70),t._m(71),t._m(72),a("p",[t._v("适当的加入给数据表加入索引可以大大提高查询效率，尤其在有大数据的情况下，效果是显著的。")]),t._m(73),t._m(74),t._m(75),t._m(76),t._m(77),t._m(78),t._m(79),a("p",[t._v("用例子说话，先定义如下数据：")]),t._m(80),t._m(81),t._m(82),t._m(83),a("p",[t._v("可聚合的表达式有：")]),t._m(84),t._m(85),t._m(86),t._m(87)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"初识mongodb"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#初识mongodb","aria-hidden":"true"}},[this._v("#")]),this._v(" 初识"),s("code",[this._v("Mongodb")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"mongodb"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mongodb","aria-hidden":"true"}},[this._v("#")]),s("code",[this._v("mongodb")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("简单来说"),a("code",[t._v("mongodb")]),t._v("是一个数据库系统，它和"),a("code",[t._v("sql")]),t._v("、"),a("code",[t._v("mysql")]),t._v("的区别在于，它是一个"),a("strong",[t._v("非关系型")]),t._v("数据库系统，它能将数据存储为以"),a("code",[t._v("key=>value")]),t._v("的形式，类似于我们常用的"),a("code",[t._v("JSON")]),t._v("对象。一是这样操作起来方便，二也大大提高了数据存储的性能。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("注意")]),s("p",[this._v("以上只是我自己的一些粗浅的见解。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装","aria-hidden":"true"}},[this._v("#")]),this._v(" 安装")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("提示")]),s("p",[this._v("安装环境：Mac")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("直接使用"),s("code",[this._v("brew")]),this._v("安装：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("brew "),s("span",{attrs:{class:"token function"}},[this._v("install")]),this._v(" mongodb\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("如果需要安装指定版本的"),s("code",[this._v("mongodb")]),this._v("，直接在后面注明版本号即可：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("brew "),s("span",{attrs:{class:"token function"}},[this._v("install")]),this._v(" mongodb@3.4\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("启动"),s("code",[this._v("mongodb")]),this._v("服务：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("brew services start mongodb "),s("span",{attrs:{class:"token comment"}},[this._v("# 启动服务")]),this._v("\nbrew services stop mongodb  "),s("span",{attrs:{class:"token comment"}},[this._v("# 关闭服务")]),this._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"简单使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简单使用","aria-hidden":"true"}},[this._v("#")]),this._v(" 简单使用")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("直接使用命令"),s("code",[this._v("mongo")]),this._v("即可进入数据库，如下：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("其中有告诉我们连接的是哪个服务，比如上图中的"),s("code",[this._v("connecting to: mongodb://127.0.0.1:27017")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("接下来我们可以使用"),s("code",[this._v("db")]),this._v("、"),s("code",[this._v("show dbs")]),this._v("来查看当前有哪些数据库，这个自行操作即可。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"创建-选择数据库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建-选择数据库","aria-hidden":"true"}},[this._v("#")]),this._v(" 创建/选择数据库")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("使用命令"),s("code",[this._v("use databaseName")]),this._v("即可选择已有的数据库，如果该库不存在，则会创建。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("use dbDemo\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("创建成功后，可以使用"),s("code",[this._v("show dbs")]),this._v("查看已经创建的数据库。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("警告")]),s("p",[this._v("如果新创建的数据库没有数据的话，则不会显示在"),s("code",[this._v("show dbs")]),this._v("的列表中。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"插入数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#插入数据","aria-hidden":"true"}},[this._v("#")]),this._v(" 插入数据")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("可以直接使用"),s("code",[this._v("insert")]),this._v("命令完成数据插入的操作：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("db.dbDemo.insert"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token string"}},[t._v('"name"')]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),a("span",{attrs:{class:"token string"}},[t._v('"我是dbDemo数据库中的第一条数据"')]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v('# 成功后会提示 WriteResult({"nInserted":1}) 表示成功插入了一跳数据')]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"删除数据库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除数据库","aria-hidden":"true"}},[this._v("#")]),this._v(" 删除数据库")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("删除数据库可使用命令"),s("code",[this._v("db.dropDatabase()")]),this._v("操作：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("use dbDemo "),a("span",{attrs:{class:"token comment"}},[t._v("# 选择进入dbDemo数据库")]),t._v("\ndb.dropDatabase"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("# 执行删除命令")]),t._v("\n\nshow dbs "),a("span",{attrs:{class:"token comment"}},[t._v("# 显示已有数据库")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v('# 删除成功会提示 {"dropped":"dbDemo","ok":1} 并会发现dbDemo也不在数据库列表里了')]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("警告")]),s("p",[this._v("删除数据库前"),s("strong",[this._v("必须先进入要删除的数据库")]),this._v("才能进行！！！")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"创建数据集合-也就是数据表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建数据集合-也就是数据表","aria-hidden":"true"}},[this._v("#")]),this._v(" 创建数据集合(也就是数据表)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("使用"),s("code",[this._v("db.createCollection(name, option)")])]),s("li",[this._v("直接使用"),s("code",[this._v("db.database.insert()")]),this._v("插入数据的时候创建")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# 第一种方式")]),t._v("\nuse dbDemo "),a("span",{attrs:{class:"token comment"}},[t._v("# 选择数据库")]),t._v("\ndb.createCollection"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'table1'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("# 创建一个名为table1的数据集合(表)")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v('# {"ok":1} 成功创建一行')]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 第二种方式")]),t._v("\ndb.table2.insert"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token string"}},[t._v('"name"')]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),a("span",{attrs:{class:"token string"}},[t._v('"我是table2中的数据"')]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("# table2不存在 故直接创建并插入一条数据")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v('# WriteResult({"nInserted":1})')]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("通过命令"),s("code",[this._v("show tables")]),this._v("或者"),s("code",[this._v("show collections")]),this._v("查看创建出的数据集合(表)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("使用"),s("code",[this._v("db.createCollection(name, option)")]),this._v("的可选"),s("code",[this._v("option")]),this._v("如下：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("字段")]),a("th",[t._v("类型")]),a("th",[t._v("说明")])])]),a("tbody",[a("tr",[a("td",[t._v("capped")]),a("td",[t._v("Boolean")]),a("td",[t._v("(可选)如果为 true，则创建固定集合。固定集合是指有着固定大小的集合，当达到最大值时，它会自动覆盖最早的文档。当该值为 true 时，必须指定 size 参数。")])]),a("tr",[a("td",[t._v("autoIndexId")]),a("td",[t._v("Boolean")]),a("td",[t._v("(可选)如为 true，自动在 _id 字段创建索引。默认为 false。")])]),a("tr",[a("td",[t._v("size")]),a("td",[t._v("Number")]),a("td",[t._v("(可选)为固定集合指定一个最大值（以字节计）。如果 capped 为 true，也需要指定该字段。")])]),a("tr",[a("td",[t._v("max")]),a("td",[t._v("Number")]),a("td",[t._v("(可选)指定固定集合中包含文档的最大数量。")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"删除数据集合-表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除数据集合-表","aria-hidden":"true"}},[this._v("#")]),this._v(" 删除数据集合(表)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("使用命令"),s("code",[this._v("db.table.drop()")]),this._v("即可删除：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("use dbDemo "),a("span",{attrs:{class:"token comment"}},[t._v("# 选择数据库")]),t._v("\ndb.table2.drop"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("# 删除table2")]),t._v("\n\nshow tables\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 会发现table2已经没了")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"插入数据-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#插入数据-2","aria-hidden":"true"}},[this._v("#")]),this._v(" 插入数据")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("code",[t._v("db.table.insert(obj|array)")]),t._v(" 可插入单条也可以插入多条")]),a("li",[a("code",[t._v("db.table.insertOne(obj)")]),t._v(" 插入单条数据")]),a("li",[a("code",[t._v("db.table.insertMany(array)")]),t._v(" 插入多条数据")]),a("li",[a("code",[t._v("db.table.save(obj)")]),t._v(" 这种写法如果不指定 id 的情况下，就是执行插入操作；如果指定 id 了，则执行更新操作")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"数据更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据更新","aria-hidden":"true"}},[this._v("#")]),this._v(" 数据更新")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("更新数据可以使用"),s("code",[this._v("db.table.update")]),this._v("和"),s("code",[this._v("db.table.save")]),this._v("两种方式进行更新。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("db.table.update")]),this._v("：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("db.table.update"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  condition,\n  update,\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    upsert: Boolean,\n    multi: Boolean,\n    writeConcern: Document\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("strong",[t._v("condition")]),t._v(": 查询条件")]),a("li",[a("strong",[t._v("update")]),t._v(": 更新内容，会带有一些操作符例如$set,$inc 之类的")]),a("li",[a("strong",[t._v("upsert")]),t._v(": 记录不存在的情况下是否执行插入操作，默认"),a("code",[t._v("false")])]),a("li",[a("strong",[t._v("multi")]),t._v(": 是否查询全部，默认"),a("code",[t._v("false")])]),a("li",[t._v("writeConcern: 报错时抛出错误的级别，了解即可")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# 插入一条张三的信息")]),t._v("\ndb.table.insert"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token string"}},[t._v("'name'")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),a("span",{attrs:{class:"token string"}},[t._v("'张三'")]),t._v(", "),a("span",{attrs:{class:"token string"}},[t._v("'age'")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" 23"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 更新张三的名称，将张三的名字改为李四")]),t._v("\ndb.table.update"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token string"}},[t._v("'name'")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),a("span",{attrs:{class:"token string"}},[t._v("'张三'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$set")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token string"}},[t._v("'name'")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),a("span",{attrs:{class:"token string"}},[t._v("'李四'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v('# WriteResult({"nMatched": 1, "nUpserted": 0, "nModified": 1}) 更新成功输出信息')]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("db.table.save")]),this._v("：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("db.table.save"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  document,\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    writeConcern: document\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("strong",[this._v("document")]),this._v(": 文档数据")]),s("li",[this._v("writeConcern: 报错时抛出错误的级别，了解即可")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# 更新李四的数据为张三")]),t._v("\n\ndb.table.save"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token string"}},[t._v("'_id'")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" ObjectId"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"56064f89ade2f21f36b03136"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",\n  "),a("span",{attrs:{class:"token string"}},[t._v("'name'")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'张三'")]),t._v(",\n  "),a("span",{attrs:{class:"token string"}},[t._v("'age'")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" 23\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"删除文档"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除文档","aria-hidden":"true"}},[this._v("#")]),this._v(" 删除文档")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("code",[this._v("db.table.deleteMany(condition)")]),this._v(" 删除符合条件的多条记录")]),s("li",[s("code",[this._v("db.table.deleteOne(condition)")]),this._v(" 删除符合条件的第一条记录")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# 删除年龄为23的第一条记录")]),t._v("\ndb.table.deleteOne"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token string"}},[t._v("'age'")]),t._v(":23"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 删除所有年龄为23的数据")]),t._v("\ndb.table.deleteMany"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token string"}},[t._v("'age'")]),t._v(":23"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"查询文档"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查询文档","aria-hidden":"true"}},[this._v("#")]),this._v(" 查询文档")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"普通查询"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#普通查询","aria-hidden":"true"}},[this._v("#")]),this._v(" 普通查询")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("使用"),s("code",[this._v("db.table.find()")]),this._v("进行文档查询：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("db.table.find"),s("span",{attrs:{class:"token punctuation"}},[this._v("(")]),this._v("\n  condition,\n  projection\n"),s("span",{attrs:{class:"token punctuation"}},[this._v(")")]),this._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("strong",[this._v("condition")]),this._v(": 查询条件")]),s("li",[s("strong",[this._v("projection")]),this._v(": 返回指定的键值。查询时如果返回所有键值，省略该参数即可。")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),a("p",[a("code",[t._v("projection")]),t._v("指定有两种模式，且这两种模式不可"),a("strong",[t._v("混用")]),t._v("，如果混用，系统无法推断其他键值是否返回。")]),a("p",[a("code",[t._v("db.table.find(condition,{name:1,age:1})")]),t._v(" # includsion 模式，指定返回的键，不返回其他键")]),a("p",[a("code",[t._v("db.table.find(condition,{name:0,age:0})")]),t._v(" # exclusion 模式，指定不返回的键，其他键返回。")]),a("p",[a("code",[t._v("db.table.find(condition,{name:0,age:1})")]),t._v(" # 错误使用")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("特殊情况")]),a("p",[t._v("_id 只有在"),a("code",[t._v("includsion")]),t._v("模式下可以指定是否显示")]),a("p",[a("code",[t._v("db.table.find(condition,{_id:0,name:1})")]),t._v(" # id 不显")]),a("p",[a("code",[t._v("db.table.find(condition,{_id:1,name:0})")]),t._v(" # 报错")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"条件查询"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#条件查询","aria-hidden":"true"}},[this._v("#")]),this._v(" 条件查询")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# 查找年龄小于等于25岁的数据")]),t._v("\ndb.table.find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("age:"),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$lte")]),t._v(":25"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 查找年龄大于16岁的数据")]),t._v("\ndb.table.find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("age:"),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$gt")]),t._v(":16"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 查找年龄大于16岁且名字叫做张三的人")]),t._v("\ndb.table.find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("age:"),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$gt")]),t._v(":16"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",name:"),a("span",{attrs:{class:"token string"}},[t._v("'张三'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 查找名字叫做张三或者年龄大于16岁的人")]),t._v("\ndb.table.find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$or")]),t._v(":"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name:"),a("span",{attrs:{class:"token string"}},[t._v("'张三'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(","),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("age:"),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$gt")]),t._v(":16"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 查找年龄大于16且名字叫张三或者李四的人")]),t._v("\ndb.table.find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("age:"),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$gt")]),t._v(":16"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(","),a("span",{attrs:{class:"token variable"}},[t._v("$or")]),t._v(":"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name:"),a("span",{attrs:{class:"token string"}},[t._v("'张三'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(","),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name:"),a("span",{attrs:{class:"token string"}},[t._v("'李四'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 模糊查询，查询名字中带有张字的人")]),t._v("\ndb.table.find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name:/张/"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 查询名字中以张开头的人")]),t._v("\ndb.table.find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name:/^张/"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 查询名字中以张结尾的人")]),t._v("\ndb.table.find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name:/张$/"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("操作符速记小技巧")]),a("p",[a("code",[t._v("$gt")]),t._v(": greater then "),a("code",[t._v(">")])]),a("p",[a("code",[t._v("$gte")]),t._v(": gt equal "),a("code",[t._v(">=")])]),a("p",[a("code",[t._v("$lt")]),t._v(": less then "),a("code",[t._v("<")])]),a("p",[a("code",[t._v("$lte")]),t._v(": lt equal "),a("code",[t._v("<=")])]),a("p",[a("code",[t._v("$ne")]),t._v(": not equal "),a("code",[t._v("!=")])]),a("p",[a("code",[t._v("eq")]),t._v(": equal "),a("code",[t._v("=")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"限制长度"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#限制长度","aria-hidden":"true"}},[this._v("#")]),this._v(" 限制长度")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# 查询年龄大于16岁的 前10条数据")]),t._v("\ndb.table.find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("age:"),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$gt")]),t._v(":16"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".limit"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("10"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"跳过查询"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#跳过查询","aria-hidden":"true"}},[this._v("#")]),this._v(" 跳过查询")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# 查询年龄大于16岁的 第11-20条数据")]),t._v("\ndb.table.find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("age:"),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$gt")]),t._v(":16"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".limit"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("10"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".skip"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("10"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("提示")]),s("p",[this._v("结合"),s("code",[this._v("limit")]),this._v("和"),s("code",[this._v("skip")]),this._v("可做分页查询")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"排序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#排序","aria-hidden":"true"}},[this._v("#")]),this._v(" 排序")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("排序是难免的，经常有数据按某个字段升序或者降序排列，使用"),s("code",[this._v("db.table.find().sort()")]),this._v("可进行排序操作：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# 检索数据并按年龄的升序顺序进行排列")]),t._v("\ndb.table.find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(","),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("_id:0"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".sort"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("age:1"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),a("p",[a("code",[t._v("sort")]),t._v("中，指定排序"),a("code",[t._v("key")]),t._v("为"),a("code",[t._v("1")]),t._v("或者"),a("code",[t._v("-1")]),t._v("来进行排序，其中"),a("code",[t._v("1")]),t._v("为升序，"),a("code",[t._v("-1")]),t._v("为降序")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("警告")]),a("p",[t._v("当"),a("code",[t._v("limit")]),t._v("、"),a("code",[t._v("skip")]),t._v("、"),a("code",[t._v("sort")]),t._v("三个一起执行的时候，"),a("code",[t._v("db.table.find().limit().skip().sort()")]),t._v("，先执行"),a("code",[t._v("sort")]),t._v("，再执行"),a("code",[t._v("skip")]),t._v("，最后才是"),a("code",[t._v("limit")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"索引"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#索引","aria-hidden":"true"}},[this._v("#")]),this._v(" 索引")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("建立索引使用"),a("code",[t._v("db.table.createIndex(key, options)")]),t._v("，和"),a("code",[t._v("sort")]),t._v("一样，"),a("code",[t._v("key")]),t._v("可以指定"),a("code",[t._v("1")]),t._v("和"),a("code",[t._v("-1")]),t._v("进行升序降序的排列。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# 单字段索引")]),t._v("\ndb.table.createIndex"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name:1"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 多字段索引")]),t._v("\ndb.table.createIndex"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name:1,age:-1"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("其中"),s("code",[this._v("options")]),this._v("的可选值有：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("属性")]),a("th",[t._v("类型")]),a("th",[t._v("介绍")])])]),a("tbody",[a("tr",[a("td",[a("strong",[t._v("background")])]),a("td",[t._v("Boolean")]),a("td",[t._v('建索引过程会阻塞其它数据库操作，background 可指定以后台方式创建索引，即增加 "background" 可选参数。 "background" 默认值为 false')])]),a("tr",[a("td",[a("strong",[t._v("unique")])]),a("td",[t._v("Boolean")]),a("td",[t._v("建立的索引是否唯一。指定为 true 创建唯一索引。默认值为 false")])]),a("tr",[a("td",[a("strong",[t._v("name")])]),a("td",[t._v("String")]),a("td",[t._v("索引的名称。如果未指定，MongoDB 的通过连接索引的字段名和排序顺序生成一个索引名称")])]),a("tr",[a("td",[a("strong",[t._v("sparse")])]),a("td",[t._v("Boolean")]),a("td",[t._v("对文档中不存在的字段数据不启用索引；这个参数需要特别注意，如果设置为 true 的话，在索引字段中不会查询出不包含对应字段的文档。默认值为 false")])]),a("tr",[a("td",[a("strong",[t._v("expireAfterSeconds")])]),a("td",[t._v("Int")]),a("td",[t._v("指定一个以秒为单位的数值，完成 TTL 设定，设定集合的生存时间")])]),a("tr",[a("td",[a("strong",[t._v("weights")])]),a("td",[t._v("Document")]),a("td",[t._v("索引权重值，数值在 1 到 99,999 之间，表示该索引相对于其他索引字段的得分权重")])]),a("tr",[a("td",[a("strong",[t._v("default_language")])]),a("td",[t._v("String")]),a("td",[t._v("对于文本索引，该参数决定了停用词及词干和词器的规则的列表。 默认为英语")])]),a("tr",[a("td",[a("strong",[t._v("language_override")])]),a("td",[t._v("String")]),a("td",[t._v("对于文本索引，该参数指定了包含在文档中的字段名，语言覆盖默认的 language，默认值为 language")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"聚合"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#聚合","aria-hidden":"true"}},[this._v("#")]),this._v(" 聚合")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("聚合")]),this._v("主要用于处理数据，比如求平均值，求和等，并返回数据结果。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在"),s("code",[this._v("mongodb")]),this._v("中使用"),s("code",[this._v("aggregate()")]),this._v("方法完成聚合。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    _id: ObjectId"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("7df78ad8902c"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",\n    bookName: "),a("span",{attrs:{class:"token string"}},[t._v("'JavaScript高级程序指南'")]),t._v(",\n    owner: "),a("span",{attrs:{class:"token string"}},[t._v("'张三'")]),t._v(",\n    like: 50\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    _id: ObjectId"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("7df78ad8902d"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",\n    bookName: "),a("span",{attrs:{class:"token string"}},[t._v("'你不知道的JavaScript'")]),t._v(",\n    owner: "),a("span",{attrs:{class:"token string"}},[t._v("'李四'")]),t._v(",\n    like: 60\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    _id: ObjectId"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("7df78ad8902e"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",\n    bookName: "),a("span",{attrs:{class:"token string"}},[t._v("'深入浅出Node.js'")]),t._v(",\n    owner: "),a("span",{attrs:{class:"token string"}},[t._v("'张三'")]),t._v(",\n    like: 70\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("然后我们使用"),s("code",[this._v("aggregate")]),this._v("对上面的数据做个分组，并且统计每个人拥有的书籍数量：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("db.table.aggregate"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$group")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("_id: "),a("span",{attrs:{class:"token string"}},[t._v("'"),a("span",{attrs:{class:"token variable"}},[t._v("$owner")]),t._v("'")]),t._v(", bookNumber: "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$sum")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" 1"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 得到结果如下")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token string"}},[t._v('"_id"')]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"李四"')]),t._v(","),a("span",{attrs:{class:"token string"}},[t._v('"BookNumber: 1"')]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token string"}},[t._v('"_id"')]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"张三"')]),t._v(","),a("span",{attrs:{class:"token string"}},[t._v('"BookNumber: 2"')]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("警告")]),a("p",[a("code",[t._v("_id")]),t._v("目前发现不可自定义，否则会报 "),a("code",[t._v("the field 'xxx' must be an accumulator object")]),t._v("的错误")]),a("p",[t._v("还有跟在"),a("code",[t._v("_id")]),t._v("后的 "),a("code",[t._v("$owner")]),t._v("的"),a("code",[t._v("$")]),t._v("号不能少，不然查询出来的结果将会错误。")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("code",[t._v("$sum")]),t._v(": 计算总和")]),a("li",[a("code",[t._v("$avg")]),t._v(": 计算平均值")]),a("li",[a("code",[t._v("$min")]),t._v(": 获取集合中所有文档对应值的最小值")]),a("li",[a("code",[t._v("$max")]),t._v(": 获取集合中所有文档对应值的最大值")]),a("li",[a("code",[t._v("$push")]),t._v(": 将结果文档中插入值到一个数组中")]),a("li",[a("code",[t._v("$addToSet")]),t._v(": 在结果文档中插入值到一个数组中，但不创建副本")]),a("li",[a("code",[t._v("$first")]),t._v(": 根据资源文档的排序获取第一个文档数据")]),a("li",[a("code",[t._v("$last")]),t._v(": 根据资源文档的排序获取最后一个文档数据")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("类似于"),s("code",[this._v("$group")]),this._v("的管道操作还有：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("code",[t._v("$project")]),t._v(": 修改输入文档的结构。可以用来重命名，增加或者删除域，也可以用于创建计算结果。")]),a("li",[a("code",[t._v("$match")]),t._v(": 用于过滤数据，只输出符合要求的文档")]),a("li",[a("code",[t._v("$limit")]),t._v(": 限制返回的文档数")]),a("li",[a("code",[t._v("$skip")]),t._v(":  跳过指定数量的文档数，并返回余下的文档")]),a("li",[a("code",[t._v("$unwind")]),t._v(": 将文档中的某一个数组类型字段拆分成多条，每条包含数组中的一个值")]),a("li",[a("code",[t._v("$group")]),t._v(": 分组文档，常用于统计")]),a("li",[a("code",[t._v("$sort")]),t._v(": 将文档排序后输出")]),a("li",[a("code",[t._v("$geoNear")]),t._v(": 输出接近某一地理位置的有序文档")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# 获取50<喜欢人数<=60的书籍数量，并统计")]),t._v("\ndb.table.aggregate"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$match")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("like: "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$gt")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" 50, "),a("span",{attrs:{class:"token variable"}},[t._v("$lte")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" 60"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$group")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("_id: null, count: "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token variable"}},[t._v("$sum")]),a("span",{attrs:{class:"token keyword"}},[t._v(":")]),t._v(" 1"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])}],!1,null,null,null);s.default=e.exports}}]);