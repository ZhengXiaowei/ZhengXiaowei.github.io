<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>移动端问题锦集 | Xiao Blog</title>
    <meta name="description" content="">
    <link rel="icon" href="/logo.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/31.styles.72922159.css" as="style"><link rel="preload" href="/assets/js/app.a03d4e4f.js" as="script"><link rel="preload" href="/assets/js/0.0f59b883.js" as="script"><link rel="prefetch" href="/assets/js/1.9796cf5f.js"><link rel="prefetch" href="/assets/js/2.2a946d02.js"><link rel="prefetch" href="/assets/js/3.59a83de8.js"><link rel="prefetch" href="/assets/js/4.21fdbdec.js"><link rel="prefetch" href="/assets/js/5.a09ec324.js"><link rel="prefetch" href="/assets/js/6.d6543f82.js"><link rel="prefetch" href="/assets/js/7.3de0ccee.js"><link rel="prefetch" href="/assets/js/8.88711e9b.js"><link rel="prefetch" href="/assets/js/9.338fb1f3.js"><link rel="prefetch" href="/assets/js/10.538a23d4.js"><link rel="prefetch" href="/assets/js/11.55badfb5.js"><link rel="prefetch" href="/assets/js/12.6f950838.js"><link rel="prefetch" href="/assets/js/13.5399a19b.js"><link rel="prefetch" href="/assets/js/14.451eca1f.js"><link rel="prefetch" href="/assets/js/15.35ff6acf.js"><link rel="prefetch" href="/assets/js/16.ece38f4c.js"><link rel="prefetch" href="/assets/js/17.3bcb6de9.js"><link rel="prefetch" href="/assets/js/18.74c09d5d.js"><link rel="prefetch" href="/assets/js/19.aa302882.js"><link rel="prefetch" href="/assets/js/20.d26e17c2.js"><link rel="prefetch" href="/assets/js/21.140f1446.js"><link rel="prefetch" href="/assets/js/22.d56b6200.js"><link rel="prefetch" href="/assets/js/23.c0b205ad.js"><link rel="prefetch" href="/assets/js/24.e3ca6758.js"><link rel="prefetch" href="/assets/js/25.5bbdea6c.js"><link rel="prefetch" href="/assets/js/26.15fba687.js"><link rel="prefetch" href="/assets/js/27.36d4982c.js"><link rel="prefetch" href="/assets/js/28.ef10919f.js"><link rel="prefetch" href="/assets/js/29.1fd2d94f.js"><link rel="prefetch" href="/assets/js/30.152778aa.js">
    <link rel="stylesheet" href="/assets/css/31.styles.72922159.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Xiao Blog
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>JavaScript</span><!----></p><ul class="sidebar-group-items"><li><a href="/javascript/" class="sidebar-link">前端缓存</a></li><li><a href="/javascript/partner.html" class="sidebar-link">设计模式</a></li><li><a href="/javascript/canvas.html" class="sidebar-link">canvas踩坑记</a></li><li><a href="/javascript/listview.html" class="sidebar-link">List-view 实现</a></li><li><a href="/javascript/typescript.html" class="sidebar-link">Typescript</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Vue</span><!----></p><ul class="sidebar-group-items"><li><a href="/vue/" class="sidebar-link">Vuex学习笔记</a></li><li><a href="/vue/vuex-persistence.html" class="sidebar-link">Vuex 持久化方案一</a></li><li><a href="/vue/vueMultipage.html" class="sidebar-link">vue多页配置</a></li><li><a href="/vue/optimize.html" class="sidebar-link">vue项目优化</a></li><li><a href="/vue/parcel-vue.html" class="sidebar-link">parcel-vue初体验</a></li><li><a href="/vue/sync-component.html" class="sidebar-link">异步组件</a></li><li><a href="/vue/rebuild.html" class="sidebar-link">重构Vue阅读器</a></li><li><a href="/vue/vue-tsx.html" class="sidebar-link">搭建vue-tsx风格的开发模板</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>WebApp</span><!----></p><ul class="sidebar-group-items"><li><a href="/webapp/" class="sidebar-link">cordova 打包</a></li><li><a href="/webapp/questions.html" class="active sidebar-link">移动端问题锦集</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webapp/questions.html#移动端-1px-问题" class="sidebar-link">移动端 1px 问题</a></li><li class="sidebar-sub-header"><a href="/webapp/questions.html#rem-和-px-的取舍" class="sidebar-link">rem 和 px 的取舍</a></li><li class="sidebar-sub-header"><a href="/webapp/questions.html#移动端点击背景图-链接有底色" class="sidebar-link">移动端点击背景图/链接有底色</a></li><li class="sidebar-sub-header"><a href="/webapp/questions.html#禁止选择文字-图片" class="sidebar-link">禁止选择文字/图片</a></li><li class="sidebar-sub-header"><a href="/webapp/questions.html#禁止复制-保存图片" class="sidebar-link">禁止复制/保存图片</a></li><li class="sidebar-sub-header"><a href="/webapp/questions.html#页面动画容易出现闪烁白屏" class="sidebar-link">页面动画容易出现闪烁白屏</a></li><li class="sidebar-sub-header"><a href="/webapp/questions.html#使用float排列布局容易出现断层" class="sidebar-link">使用float排列布局容易出现断层</a></li><li class="sidebar-sub-header"><a href="/webapp/questions.html#斜边布局" class="sidebar-link">斜边布局</a></li><li class="sidebar-sub-header"><a href="/webapp/questions.html#transform-和-fixed" class="sidebar-link">transform 和 fixed</a></li><li class="sidebar-sub-header"><a href="/webapp/questions.html#遮罩层滚动点透问题" class="sidebar-link">遮罩层滚动点透问题</a></li><li class="sidebar-sub-header"><a href="/webapp/questions.html#使用webkit-overflow-scrolling-touch的坑" class="sidebar-link">使用webkit-overflow-scrolling:touch的坑</a></li><li class="sidebar-sub-header"><a href="/webapp/questions.html#spa路由使用history模式下的微信分享bug" class="sidebar-link">SPA路由使用history模式下的微信分享bug</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Flutter</span><!----></p><ul class="sidebar-group-items"><li><a href="/flutter/" class="sidebar-link">环境搭建</a></li><li><a href="/flutter/dart.html" class="sidebar-link">Dart基础语法</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Services</span><!----></p><ul class="sidebar-group-items"><li><a href="/services/" class="sidebar-link">Mongodb 好像有点意思？</a></li><li><a href="/services/mongodb.html" class="sidebar-link">正经学个mongoDB吧！</a></li><li><a href="/services/python.html" class="sidebar-link">学学Python吧~</a></li><li><a href="/services/mysql.html" class="sidebar-link">向mysql低头</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>其他</span><!----></p><ul class="sidebar-group-items"><li><a href="/others/" class="sidebar-link">VSCode 常用插件推荐</a></li><li><a href="/others/vsESlint.html" class="sidebar-link">VSCode ESLint 配置</a></li><li><a href="/others/nginx.html" class="sidebar-link">nginx服务器搭建</a></li><li><a href="/others/android-dev.html" class="sidebar-link">Mac 配置 Android 环境</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="移动端问题锦集"><a href="#移动端问题锦集" aria-hidden="true" class="header-anchor">#</a> 移动端问题锦集</h1><h2 id="移动端-1px-问题"><a href="#移动端-1px-问题" aria-hidden="true" class="header-anchor">#</a> 移动端 1px 问题</h2><blockquote><p>产生原因</p></blockquote><p>简单点说就是因为 Retine 屏的分辨率始终是普通屏幕的 2 倍，1px 的边框在<code>devicePixelRatio=2</code>的 retina 屏下会显示成 2px，所以在高清屏下 1px 就显得和 2px 差不多，具体细节可以参考<a href="http://www.w3cplus.com/css/towards-retina-web.html" target="_blank" rel="noopener noreferrer">这篇文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><blockquote><p>解决方案</p></blockquote><ul><li>使用媒体查询</li></ul><div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.border_1px</span> <span class="token punctuation">{</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #f1f1f1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span> 2<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">.border_1px</span> <span class="token punctuation">{</span>
    <span class="token property">border</span><span class="token punctuation">:</span> 0.5px solid #f1f1f1<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">缺点</p><p>兼容性差，有的 retina 屏会将 0.5 识别成 0px</p></div><ul><li>伪类配合 transform</li></ul><div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token func"><span class="token function">border-1px</span><span class="token punctuation">(</span>$color <span class="token operator">=</span> <span class="token hexcode">#ccc</span><span class="token punctuation">,</span> $radius <span class="token operator">=</span> <span class="token number">2</span>px<span class="token punctuation">,</span> $style <span class="token operator">=</span> solid<span class="token punctuation">)</span></span>
  <span class="token property-declaration"><span class="token property">position</span> relative</span>

  <span class="token selector">&amp;:after</span>
    <span class="token property-declaration"><span class="token property">content</span> <span class="token string">''</span></span>
    <span class="token property-declaration"><span class="token property">pointer-events</span> none </span><span class="token comment">// 解决iphone上的点击无效Bug</span>
    <span class="token property-declaration"><span class="token property">display</span> block</span>
    <span class="token property-declaration"><span class="token property">position</span> absolute</span>
    <span class="token property-declaration"><span class="token property">left</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">top</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">transform-origin</span> <span class="token number">0</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">border</span> <span class="token number">1</span>px $style $color</span>
    <span class="token property-declaration"><span class="token property">border-radius</span> $radius</span>
    <span class="token property-declaration"><span class="token property">box-sizing</span> border-box</span>
    <span class="token property-declaration"><span class="token property">width</span> <span class="token number">100%</span></span>
    <span class="token property-declaration"><span class="token property">height</span> <span class="token number">100%</span></span>

    <span class="token atrule-declaration"><span class="token atrule">@media</span> <span class="token punctuation">(</span>-webkit-min-device-pixel-ratio<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>min-device-pixel-ratio<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
      <span class="token property-declaration"><span class="token property">width</span> <span class="token number">200%</span></span>
      <span class="token property-declaration"><span class="token property">height</span> <span class="token number">200%</span></span>
      <span class="token property-declaration"><span class="token property">border-radius</span> $radius <span class="token operator">*</span> <span class="token number">2</span></span>
      <span class="token property-declaration"><span class="token property">transform</span> <span class="token func"><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token func"><span class="token function">translateZ</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span></span></span>

    <span class="token atrule-declaration"><span class="token atrule">@media</span> <span class="token punctuation">(</span>-webkit-min-device-pixel-ratio<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>min-device-pixel-ratio<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">)</span></span>
      <span class="token property-declaration"><span class="token property">width</span> <span class="token number">300%</span></span>
      <span class="token property-declaration"><span class="token property">height</span> <span class="token number">300%</span></span>
      <span class="token property-declaration"><span class="token property">border-radius</span> $radius <span class="token operator">*</span> <span class="token number">3</span></span>
      <span class="token property-declaration"><span class="token property">transform</span> <span class="token func"><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">0.33</span><span class="token punctuation">)</span> <span class="token func"><span class="token function">translateZ</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span></span></span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">缺点</p><p>如果碰上其他伪类并存，则需要多层嵌套</p></div><ul><li>使用 box-shadow 模拟</li></ul><div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.border_1px</span> <span class="token punctuation">{</span>
  <span class="token property">box-shadow</span><span class="token punctuation">:</span> inset 0px -1px 1px -1px #f1f1f1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">缺点</p><p>边框有阴影，颜色略浅</p></div><ul><li>使用 view-port</li></ul><p>对于<code>devicePixelRatio=2</code>的：</p><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>initial-scale=0.5, maximum-scale=0.5, minimum-scale=0.5, user-scalable=no<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>对于<code>devicePixelRatio=3</code>的：</p><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>initial-scale=0.3333333333333333, maximum-scale=0.3333333333333333, minimum-scale=0.3333333333333333, user-scalable=no<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>可以使用<code>js</code>判断后动态插入：</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> dpr <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> ratio <span class="token operator">=</span> window<span class="token punctuation">.</span>devicePixelRatio<span class="token punctuation">;</span>
<span class="token keyword">let</span> doc <span class="token operator">=</span> document<span class="token punctuation">;</span>
<span class="token keyword">let</span> head <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;head&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>ratio <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  dpr <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ratio <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  dpr <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> scale <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> dpr<span class="token punctuation">;</span>
<span class="token keyword">let</span> meta <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;meta&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
meta<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;viewport&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
meta<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>
  <span class="token string">&quot;content&quot;</span><span class="token punctuation">,</span>
  <span class="token template-string"><span class="token string">`initial-scale=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scale<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, maximum-scale=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scale<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, minimum-scale=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scale<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, user-scalable=no`</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>meta<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="rem-和-px-的取舍"><a href="#rem-和-px-的取舍" aria-hidden="true" class="header-anchor">#</a><code>rem</code> 和 <code>px</code> 的取舍</h2><p>如果项目只适配手机端，<code>px</code>和<code>rem</code>可以根据个人习惯自主选择。</p><p>如果项目适配多种设备，比如手机和 pad 设备，分辨率差的比较大的情况下，使用<code>rem</code>最优</p><h2 id="移动端点击背景图-链接有底色"><a href="#移动端点击背景图-链接有底色" aria-hidden="true" class="header-anchor">#</a> 移动端点击背景图/链接有底色</h2><div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* 点击的时候底色透明即可 */</span>
<span class="token property">-webkit-tap-highlight-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>
</code></pre></div><h2 id="禁止选择文字-图片"><a href="#禁止选择文字-图片" aria-hidden="true" class="header-anchor">#</a> 禁止选择文字/图片</h2><div class="language-css extra-class"><pre class="language-css"><code><span class="token property">-webkit-touch-callout</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token property">-webkit-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token property">-khtml-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token property">-moz-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token property">-ms-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token property">user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
</code></pre></div><h2 id="禁止复制-保存图片"><a href="#禁止复制-保存图片" aria-hidden="true" class="header-anchor">#</a> 禁止复制/保存图片</h2><div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">img</span> <span class="token punctuation">{</span>
  <span class="token property">-webkit-touch-callout</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="页面动画容易出现闪烁白屏"><a href="#页面动画容易出现闪烁白屏" aria-hidden="true" class="header-anchor">#</a> 页面动画容易出现闪烁白屏</h2><blockquote><p>使用<code>translate3d</code>优化</p></blockquote><div class="language-css extra-class"><pre class="language-css"><code><span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">translate3d</span><span class="token punctuation">(</span>0, 0, 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token property">-moz-transform</span><span class="token punctuation">:</span> <span class="token function">translate3d</span><span class="token punctuation">(</span>0, 0, 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token property">-ms-transform</span><span class="token punctuation">:</span> <span class="token function">translate3d</span><span class="token punctuation">(</span>0, 0, 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3d</span><span class="token punctuation">(</span>0, 0, 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="使用float排列布局容易出现断层"><a href="#使用float排列布局容易出现断层" aria-hidden="true" class="header-anchor">#</a> 使用<code>float</code>排列布局容易出现断层</h2><blockquote><p>出现原因</p></blockquote><p>在使用<code>float</code>布局列表的时候，容易出现某一行只出现第一个位置或者最后一个位置的内容，出现这个的原因是，上一行有某个内容的高度和其他高度不同的原因，导致将底下那一行的内容给挤了下去。</p><blockquote><p>解决</p></blockquote><p>给每个<code>item</code>设置一个<strong>最小高度/固定高度</strong>即可：</p><div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.item</span> <span class="token punctuation">{</span>
  <span class="token property">min-height</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="斜边布局"><a href="#斜边布局" aria-hidden="true" class="header-anchor">#</a> 斜边布局</h2><div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* 斜边部分 原理和小三角一样 */</span>
<span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
<span class="token property">width</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token property">height</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token property">border-width</span><span class="token punctuation">:</span> 100px 0 0 414px<span class="token punctuation">;</span> <span class="token comment">/* 底边的宽度要等于设备宽度 */</span>
<span class="token property">border-style</span><span class="token punctuation">:</span> solid<span class="token punctuation">;</span>
<span class="token property">border-color</span><span class="token punctuation">:</span> transparent transparent gray gray<span class="token punctuation">;</span>
<span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token property">z-index</span><span class="token punctuation">:</span> 99<span class="token punctuation">;</span>
</code></pre></div><p>实现效果：</p><img src="/assets/css_xie.png"><h2 id="transform-和-fixed"><a href="#transform-和-fixed" aria-hidden="true" class="header-anchor">#</a> transform 和 fixed</h2><p>在父元素使用<code>transform</code>下使用<code>fixed</code>，将会使<code>fixed</code>失效。</p><p>解决方案是：</p><ul><li>在使用了<code>transform</code>的容器中不使用<code>fixed</code>，换<code>absolute</code>，并需要通过 js 计算固定位置</li><li>依然使用<code>fixed</code>，不过使用<code>fixed</code>的容器放在使用<code>transform</code>的容器之外。</li></ul><h2 id="遮罩层滚动点透问题"><a href="#遮罩层滚动点透问题" aria-hidden="true" class="header-anchor">#</a> 遮罩层滚动点透问题</h2><p>在出现遮罩层的时候，我们可以使用<code>@touchmove.prevent</code>来防止点透的问题出现，也就是遮罩层背后的内容还能滚动的问题。但是如果这样的话，如果遮罩层内有需要滚动的容器，那将使容器的滚动也失效。</p><p>通过自身的了解和网上的收集，主要解决方案有以下几种：</p><ul><li><p>给<code>body</code>设置 css<code>{overflow:hidden}</code></p><div class="warning custom-block"><p class="custom-block-title">问题</p><p>IOS 上无效</p></div></li><li><p>给<code>body,html</code>都设置 css<code>{overflow:hidden}</code></p><div class="warning custom-block"><p class="custom-block-title">问题</p><p>a - 滚动位置会丢失，需要通过 js 设置 scrollTop</p><p>b - 没效果</p></div></li><li><p>目前比较完美的解决方案</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> scrollTop <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token comment">// 显示弹出层</span>
  open<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在弹出层显示之前，记录当前的滚动位置</span>
    scrollTop <span class="token operator">=</span> <span class="token function">getScrollTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 使body脱离文档流</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;dialog-open&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 把脱离文档流的body拉上去！否则页面会回到顶部！</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token operator">-</span>scrollTop <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>

    mask<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;block&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// 隐藏弹出层</span>
  close<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mask<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// body又回到了文档流中（我胡汉三又回来啦！）</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">&quot;dialog-open&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 滚回到老地方</span>
    <span class="token function">to</span><span class="token punctuation">(</span>scrollTop<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">to</span><span class="token punctuation">(</span>scrollTop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> scrollTop<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">getScrollTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop <span class="token operator">||</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">fixedBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> scrollTop <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop <span class="token operator">||</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cssText <span class="token operator">+=</span> <span class="token string">'position:fixed;top:-'</span><span class="token operator">+</span>scrollTop<span class="token operator">+</span><span class="token string">'px;'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">looseBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> body <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
  body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> top <span class="token operator">=</span> body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top<span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> <span class="token operator">-</span><span class="token function">parseInt</span><span class="token punctuation">(</span>top<span class="token punctuation">)</span><span class="token punctuation">;</span>
  body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul><p>不过这样依旧会有点问题，就是如果在遮罩层中滚动的时候，做点击操作，会容易出现卡死的现象，就是滚动后需要进行两次点击，再能进行对应的点击操作。对此的解决方案是，改<code>click</code>事件为<code>touchstart</code>事件。</p><h2 id="使用webkit-overflow-scrolling-touch的坑"><a href="#使用webkit-overflow-scrolling-touch的坑" aria-hidden="true" class="header-anchor">#</a> 使用<code>webkit-overflow-scrolling:touch</code>的坑</h2><p>今天遇到的了一个问题就是内容滚动有时候会出现卡住的情况，尤其是当滚动条位于最顶端或者最底下的时候，继续下拉或者上拉会导致页面卡住，这样的情况颇为频繁，找了很久都没发现问题所在，所以在尝试的情况下注释掉了<code>webkit-overflow-scrolling</code>后，发现居然好了！！！居然好了！！！</p><p>然后就针对这个问题谷歌上找了下，发现其实也很很多：</p><ul><li><p>取消<code>webkit-overflow-scrolling:touch</code>，但是这样会导致滚动时手指离开就马上停住滚动，没有了惯性滚动</p></li><li><p>让子内容的高度<code>+1px</code>，比如父容器使用了<code>webkit-overflow-scrolling:touch</code>，那么子内容的容器设置高度<code>height:calc(100% + 1px)</code>既可以解决。</p></li></ul><h2 id="spa路由使用history模式下的微信分享bug"><a href="#spa路由使用history模式下的微信分享bug" aria-hidden="true" class="header-anchor">#</a> SPA路由使用<code>history</code>模式下的微信分享bug</h2><p>会出现的一个情况是，我已进入页面是可以分享的，当时如果这时候路由变化，比如<code>replace</code>或者<code>push</code>操作之后，那么分享就会出现问题，并不会如同配置那样分享出来。因为报了<code>invaild signature</code>的错误。</p><p>这主要还区分安卓和苹果，两者的情况不同。</p><p>出现这个的原因是：</p><p>在<code>history</code>模式下，<code>vue-router</code>操作的是浏览器的历史记录，从而改变<code>URL</code>的变化。</p><p>而官方<a href="https://" target="_blank" rel="noopener noreferrer">JSSDK文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>中也有提到：</p><blockquote><p>同一个url仅需调用一次，对于变化url的SPA的web app可在每次url变化时进行调用,目前Android微信客户端不支持pushState的H5新特性，所以使用pushState来实现web app的页面会导致签名失败，此问题会在Android6.2中修复</p></blockquote><p>但是坑爹的是，<code>android</code>中出现的问题不多，因为每次<code>URL</code>变化后，微信记录的都是当前那个<code>URL</code>，而<code>IOS</code>则不然，<code>IOS</code>是微信只记录页面第一次加载进来的<code>URL</code>地址。</p><p>举个栗子：</p><p>一进入系统的地址是<code>https://a.com</code>，然后先后进入<code>a</code>、<code>b</code>，也就是<code>https://a.com/a</code>和<code>https://a.com/b</code>，然后停在<code>b</code>页面，在<code>android</code>中，微信记录的是<code>https://a.com/b</code>这个地址，而<code>IOS</code>中记录的却是<code>https://a.com</code>，也就是第一次进来的路由地址。</p><p>这个时候我们刷新页面，那么<code>https://a.com/b</code>就是<code>IOS</code>第一次进来的地址了，所以<code>IOS</code>微信中记录的地址也就变成了<code>https://a.com/b</code>了。</p><p>解决方式：</p><p>注册一个全局变量，比如可以在<code>window</code>下挂在一个<code>wxSignURL</code>的变量，当一进入页面的时候保存第一次记录的地址：<code>window.wxSignURL = location.href</code>。</p><p>这段代码可以写在<code>main.js</code>里，也可以写在<code>router.js</code>的钩子函数中，不过要区别对待，如果是<code>android</code>，则使用每次跳转后的路由，如果是<code>IOS</code>则使用记录的<code>wxSignURL</code>。</p><p>然后获取<code>微信签名</code>的时候，把这个<code>URL</code>传过去即可。</p><p><code>IOS</code>和<code>android</code>的判断使用浏览器的<code>ua</code>判断即可。根据资料，微信会在<code>window</code>下挂载一个<code>__wxjs_is_wkwebview</code>属性，如果是在<code>IOS</code>中，该值为<code>true</code>，也可以通过这个属性去判断。</p></div><div class="page-edit"><!----><div class="last-updated"><span class="prefix">上次更新: </span><span class="time">12/19/2018, 5:10:43 PM</span></div></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/webapp/" class="prev router-link-active">
          cordova 打包
        </a></span><span class="next"><a href="/flutter/">
          环境搭建
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/0.0f59b883.js" defer></script><script src="/assets/js/app.a03d4e4f.js" defer></script>
  </body>
</html>
